import{a as $,b as J,c as K}from"./chunk-JVR53OYE.js";import{a as L,b as s,c as O,d as P,e as D,f as R,g as U,h as H,i as z,j as B}from"./chunk-VUTGS4B6.js";import{a as E,b as q,j as Q,n as A,q as j,r as G}from"./chunk-YDQ4ZGZT.js";import{Ab as a,Cb as y,Ua as d,Va as C,_ as S,gb as v,ha as T,ia as M,ic as k,jc as V,kb as c,kc as N,nb as r,ob as o,pa as u,pb as w,qa as f,qb as F,rb as g,sb as I,xb as h,yb as _,zb as x}from"./chunk-4X6IT63B.js";var ee=["txtTitulo"],te=["txtSinopsis"],ie=["txtActores"],oe=["fileUpload"],re=["txtCategoria"];function ne(t,e){t&1&&(r(0,"div",25),a(1,"* Campo requerido"),o())}function ae(t,e){t&1&&(r(0,"div",25),a(1,"* Campo requerido"),o())}function le(t,e){t&1&&(r(0,"div",25),a(1,"* Campo requerido"),o())}function me(t,e){t&1&&(r(0,"div",25),a(1,"* Campo requerido"),o())}function se(t,e){if(t&1&&(r(0,"div")(1,"section",26),a(2," Detalles de la imagen: "),r(3,"ul")(4,"li"),a(5),o(),r(6,"li"),a(7),o(),r(8,"li"),a(9),o()()()()),t&2){let p=I();d(5),y("Name: ",p.file.name,""),d(2),y("Type: ",p.file.type,""),d(2),y("Size: ",p.file.size," bytes")}}function de(t,e){t&1&&(r(0,"div",25),a(1,"* Campo requerido"),o())}function ce(t,e){if(t&1){let p=F();r(0,"li",27),a(1),r(2,"mat-icon",28),g("click",function(){let n=u(p).$implicit,i=I();return f(i.deleteGenre(n.name))}),a(3,"delete"),o()()}if(t&2){let p=e.$implicit;d(),y(" ",p.name," ")}}var X=(()=>{let e=class e{constructor(l,n,i,m){this.http=l,this.fb=n,this.moviesService=i,this.router=m,this.titulo="",this.sinopsis="",this.actores="",this.portada="",this.categoria="",this.categorias=[],this.status="initial",this.movieForm=this.fb.group({titulo:["",[s.required,s.minLength(2),s.maxLength(100)]],sinopsis:["",[s.required,s.minLength(2),s.maxLength(400)]],actores:["",[s.required,s.minLength(2),s.maxLength(400)]],portada:["",[s.required,s.minLength(2),s.maxLength(100)]],categoria:["",[s.required,s.minLength(2),s.maxLength(100)]]})}ngOnInit(){}saveMovie(){this.movieForm.value.categorias=this.categorias,this.movieForm.value.portada=this.file?.name,this.moviesService.saveMovie(this.movieForm.value).subscribe({next:l=>{this.onUpload(l.movie._id)},error:l=>{alert("Ocurrio un error al crear la pelicula, intenta de nuevo."),console.log(l)},complete:()=>{}})}onChange(l){let n=l.target.files[0];n&&(this.status="initial",this.file=n)}addPortada(){this.fileUpload?.nativeElement.click()}onUpload(l){if(this.file){let n=new FormData;n.append("archivo",this.file,this.file.name),this.moviesService.uploadImage(n,l).subscribe({next:i=>{this.router.navigate(["/home"])},error:i=>{alert("Ocurrio un error al crear la pelicula, intenta de nuevo."),console.log(i)},complete:()=>{}})}}addGenre(){if(this.txtCategoria?.nativeElement.value){var l={name:this.txtCategoria?.nativeElement.value};this.categorias.push(l),this.txtCategoria.nativeElement.value=""}else this.txtCategoria?.nativeElement.focus()}deleteGenre(l){this.categorias=this.categorias.filter(n=>n.name!==l)}};e.\u0275fac=function(n){return new(n||e)(C(E),C(H),C(j),C(Q))},e.\u0275cmp=T({type:e,selectors:[["app-workspace"]],viewQuery:function(n,i){if(n&1&&(h(ee,5),h(te,5),h(ie,5),h(oe,5),h(re,5)),n&2){let m;_(m=x())&&(i.txtTitulo=m.first),_(m=x())&&(i.txtSinopsis=m.first),_(m=x())&&(i.txtActores=m.first),_(m=x())&&(i.fileUpload=m.first),_(m=x())&&(i.txtCategoria=m.first)}},decls:43,vars:9,consts:[["fileUpload",""],["txtCategoria",""],[1,"row","col-md-6","offset-md-3","mt-3","cont-body","p-4"],[3,"formGroup"],[1,"mb-3"],["for","txtTitulo",1,"form-label"],["type","text","formControlName","titulo","name","titulo","id","txtTitulo",1,"form-control"],["class","form-text text-danger",4,"ngIf"],["for","txtSinopsis",1,"form-label"],["cols","40","rows","5","formControlName","sinopsis","name","sinopsis","id","txtSinopsis",1,"form-control"],["for","txtActores",1,"form-label"],["type","text","formControlName","actores","id","txtActores",1,"form-control"],["for","filePortada",1,"form-label"],["type","button","id","filePortada","value","Seleccionar portada",1,"btn","btn-primary","m-2",3,"click"],["id","txtPortada","formControlName","portada","type","file",2,"display","none",3,"change"],[4,"ngIf"],["for","txtCategoria",1,"form-label"],[1,"row","m-0"],[1,"col-md-8","p-0"],["type","text","formControlName","categoria","id","txtCategoria",1,"form-control",3,"keyup.enter"],[1,"col-md-4","p-0"],["type","button",1,"btn","btn-primary",3,"click"],[1,"list-group"],["class","estilo-cat list-group-item d-flex justify-content-between",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"form-text","text-danger"],[1,"file-info"],[1,"estilo-cat","list-group-item","d-flex","justify-content-between"],[1,"puntero",3,"click"]],template:function(n,i){if(n&1){let m=F();r(0,"div",2)(1,"h3"),a(2,"Agregar nueva pelicula"),o(),r(3,"form",3)(4,"div",4)(5,"label",5),a(6,"Titulo:"),o(),w(7,"input",6),v(8,ne,2,0,"div",7),o(),r(9,"div",4)(10,"label",8),a(11,"Sinopsis:"),o(),w(12,"textarea",9),v(13,ae,2,0,"div",7),o(),r(14,"div",4)(15,"label",10),a(16,"Actores:"),o(),w(17,"input",11),v(18,le,2,0,"div",7),o(),r(19,"div",4)(20,"label",12),a(21,"Foto de portada:"),o(),r(22,"input",13),g("click",function(){return u(m),f(i.addPortada())}),o(),r(23,"input",14,0),g("change",function(Z){return u(m),f(i.onChange(Z))}),o(),v(25,me,2,0,"div",7)(26,se,10,3,"div",15),o(),r(27,"div",4)(28,"label",16),a(29,"Categorias:"),o(),r(30,"div",17)(31,"div",18)(32,"input",19,1),g("keyup.enter",function(){return u(m),f(i.addGenre())}),o(),v(34,de,2,0,"div",7),o(),r(35,"div",20)(36,"button",21),g("click",function(){return u(m),f(i.addGenre())}),a(37,"Agregar"),o()()()(),r(38,"div",4)(39,"ul",22),v(40,ce,4,1,"li",23),o()(),r(41,"button",24),g("click",function(){return u(m),f(i.saveMovie())}),a(42,"Guardar"),o()()()}n&2&&(d(3),c("formGroup",i.movieForm),d(5),c("ngIf",!i.movieForm.value.titulo),d(5),c("ngIf",!i.movieForm.value.sinopsis),d(5),c("ngIf",!i.movieForm.value.actores),d(7),c("ngIf",!i.movieForm.value.portada),d(),c("ngIf",i.file),d(8),c("ngIf",!i.categorias.length),d(6),c("ngForOf",i.categorias),d(),c("disabled",!i.movieForm.valid))},dependencies:[k,V,$,D,L,O,P,R,U],styles:[".cont-body[_ngcontent-%COMP%]{margin-bottom:100px;min-height:90vh;display:block}.puntero[_ngcontent-%COMP%]{cursor:pointer}.estilo-cat[_ngcontent-%COMP%]{background-color:coral;width:30%;color:#fff}"]});let t=e;return t})();var pe=[{path:"",component:X}],Y=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=M({type:e}),e.\u0275inj=S({imports:[A.forChild(pe),A]});let t=e;return t})();var Ne=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=M({type:e}),e.\u0275inj=S({providers:[q(),E],imports:[N,Y,G,K,J,z,B]});let t=e;return t})();export{Ne as AddMovieModule};
