import{a as K,b as X,c as Y}from"./chunk-JVR53OYE.js";import{a as P,b as c,c as D,d as U,e as z,f as $,g as H,h as B,i as W,j as J}from"./chunk-VUTGS4B6.js";import{a as w,b as A,h as L,j,k as Q,l as O,n as I,q as R,r as G}from"./chunk-YDQ4ZGZT.js";import{Ab as l,Cb as b,Fb as T,Ua as m,Va as _,_ as M,gb as v,ha as k,ia as S,ic as V,jc as N,kb as p,kc as q,nb as r,ob as o,pa as f,pb as g,qa as h,qb as F,rb as x,sb as u,xb as C,yb as y,zb as E}from"./chunk-4X6IT63B.js";var oe=["txtTitulo"],ne=["txtSinopsis"],re=["txtActores"],ae=["fileUpload"],le=["txtCategoria"],se=t=>["/movie/",t];function me(t,i){t&1&&(r(0,"div",29),l(1,"* Campo requerido"),o())}function ce(t,i){t&1&&(r(0,"div",29),l(1,"* Campo requerido"),o())}function de(t,i){t&1&&(r(0,"div",29),l(1,"* Campo requerido"),o())}function pe(t,i){t&1&&(r(0,"div",29),l(1,"* Campo requerido"),o())}function ue(t,i){if(t&1&&(r(0,"div")(1,"section",30),l(2," Detalles de la imagen: "),r(3,"ul")(4,"li"),l(5),o(),r(6,"li"),l(7),o(),r(8,"li"),l(9),o()()()()),t&2){let a=u(2);m(5),b("Name: ",a.file.name,""),m(2),b("Type: ",a.file.type,""),m(2),b("Size: ",a.file.size," bytes")}}function ve(t,i){t&1&&(r(0,"div",29),l(1,"* Campo requerido"),o())}function fe(t,i){if(t&1){let a=F();r(0,"li",31),l(1),r(2,"mat-icon",32),x("click",function(){let e=f(a).$implicit,s=u(2);return h(s.deleteGenre(e.name))}),l(3,"delete"),o()()}if(t&2){let a=i.$implicit;m(),b(" ",a.name," ")}}function he(t,i){if(t&1){let a=F();r(0,"div")(1,"form",4)(2,"div",5)(3,"label",6),l(4,"Titulo:"),o(),g(5,"input",7),v(6,me,2,0,"div",8),o(),r(7,"div",5)(8,"label",9),l(9,"Sinopsis:"),o(),g(10,"textarea",10),v(11,ce,2,0,"div",8),o(),r(12,"div",5)(13,"label",11),l(14,"Actores:"),o(),g(15,"input",12),v(16,de,2,0,"div",8),o(),r(17,"div",5)(18,"label",13),l(19,"Foto de portada:"),o(),g(20,"input",14),r(21,"input",15),x("click",function(){f(a);let e=u();return h(e.addPortada())}),o(),r(22,"input",16,0),x("change",function(e){f(a);let s=u();return h(s.onChange(e))}),o(),v(24,pe,2,0,"div",8)(25,ue,10,3,"div",3),o(),r(26,"div",5)(27,"label",17),l(28,"Categorias:"),o(),r(29,"div",18)(30,"div",19),g(31,"input",20),r(32,"input",21,1),x("keyup.enter",function(){f(a);let e=u();return h(e.addGenre())}),o(),v(34,ve,2,0,"div",8),o(),r(35,"div",22)(36,"button",23),x("click",function(){f(a);let e=u();return h(e.addGenre())}),l(37,"Agregar"),o()()()(),r(38,"div",5)(39,"ul",24),v(40,fe,4,1,"li",25),o()(),r(41,"div",26)(42,"button",27),x("click",function(){f(a);let e=u();return h(e.saveMovie())}),l(43,"Actualizar"),o(),r(44,"a",28),l(45,"Cancelar"),o()()()()}if(t&2){let a=u();m(),p("formGroup",a.movieForm),m(5),p("ngIf",!a.movieForm.value.titulo),m(5),p("ngIf",!a.movieForm.value.sinopsis),m(5),p("ngIf",!a.movieForm.value.actores),m(8),p("ngIf",!a.movieForm.value.portada),m(),p("ngIf",a.file),m(9),p("ngIf",!a.categorias.length),m(6),p("ngForOf",a.categorias),m(2),p("disabled",!a.movieForm.valid),m(2),p("routerLink",T(10,se,a.movie.idMovie))}}var ee=(()=>{let i=class i{constructor(n,e,s,d,ie){this.route=n,this.http=e,this.fb=s,this.moviesService=d,this.router=ie,this.movie={},this.idMovie=0,this.id="",this.titulo="",this.sinopsis="",this.actores="",this.portada="",this.categoria="",this.categorias=[],this.status="initial",this.movieForm=this.fb.group({titulo:["",[c.required,c.minLength(2),c.maxLength(100)]],sinopsis:["",[c.required,c.minLength(2),c.maxLength(400)]],actores:["",[c.required,c.minLength(2),c.maxLength(400)]],portada:["",[c.required,c.minLength(2),c.maxLength(100)]],categorias:["",[c.required]]})}ngOnInit(){this.idMovie=this.route.snapshot.params.id,this.moviesService.getMovie(this.idMovie).subscribe({next:n=>{this.movie=n.movieExistente,this.id=this.movie._id,this.categorias=this.movie.categorias,this.movieForm.patchValue({titulo:this.movie.titulo,sinopsis:this.movie.sinopsis,actores:this.movie.actores,portada:this.movie.portada,categorias:this.movie.categorias})},error:n=>{console.log(n),alert("Ocurrio un error al obtener la pelicula")}})}saveMovie(){this.movieForm.value.categorias=this.categorias,this.movieForm.value.portada=this.file?this.file.name:this.movieForm.value.portada,this.moviesService.updateMovie(this.movieForm.value,this.id).subscribe({next:n=>{this.file?this.onUpload(n.movie._id):this.router.navigate([`/movie/${this.idMovie}`])},error:n=>{console.log(n),alert("Ocurrio un error al actualizar la pelicula, intenta de nuevo.")}})}onChange(n){let e=n.target.files[0];e&&(this.status="initial",this.file=e)}addPortada(){this.fileUpload?.nativeElement.click()}onUpload(n){if(this.file){let e=new FormData;e.append("archivo",this.file,this.file.name),this.moviesService.uploadImage(e,n).subscribe({next:s=>{this.router.navigate([`/movie/${this.idMovie}`])},error:s=>{console.log(s),alert("Ocurrio un error al actualizar la pelicula, intenta de nuevo.")}})}}addGenre(){if(this.txtCategoria?.nativeElement.value){var n={name:this.txtCategoria?.nativeElement.value};this.categorias.push(n),this.txtCategoria.nativeElement.value=""}else this.txtCategoria?.nativeElement.focus()}deleteGenre(n){this.categorias=this.categorias.filter(e=>e.name!==n)}};i.\u0275fac=function(e){return new(e||i)(_(L),_(w),_(B),_(R),_(j))},i.\u0275cmp=k({type:i,selectors:[["app-workspace"]],viewQuery:function(e,s){if(e&1&&(C(oe,5),C(ne,5),C(re,5),C(ae,5),C(le,5)),e&2){let d;y(d=E())&&(s.txtTitulo=d.first),y(d=E())&&(s.txtSinopsis=d.first),y(d=E())&&(s.txtActores=d.first),y(d=E())&&(s.fileUpload=d.first),y(d=E())&&(s.txtCategoria=d.first)}},decls:4,vars:1,consts:[["fileUpload",""],["txtCategoria",""],[1,"row","col-md-6","offset-md-3","mt-3","cont-body","p-4"],[4,"ngIf"],[3,"formGroup"],[1,"mb-3"],["for","txtTitulo",1,"form-label"],["type","text","formControlName","titulo","name","titulo","id","txtTitulo",1,"form-control"],["class","form-text text-danger",4,"ngIf"],["for","txtSinopsis",1,"form-label"],["cols","40","rows","5","formControlName","sinopsis","name","sinopsis","id","txtSinopsis",1,"form-control"],["for","txtActores",1,"form-label"],["type","text","formControlName","actores","id","txtActores",1,"form-control"],["for","filePortada",1,"form-label"],["type","text","formControlName","portada","name","portada","hidden",""],["type","button","id","filePortada","value","Seleccionar portada",1,"btn","btn-primary","m-2",3,"click"],["id","txtPortada","type","file",2,"display","none",3,"change"],["for","txtCategoria",1,"form-label"],[1,"row","m-0"],[1,"col-md-8","p-0"],["type","text","formControlName","categorias","hidden",""],["type","text","id","txtCategoria",1,"form-control",3,"keyup.enter"],[1,"col-md-4","p-0"],["type","button",1,"btn","btn-primary",3,"click"],[1,"list-group"],["class","estilo-cat list-group-item d-flex justify-content-between",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-success",2,"margin-right","20px",3,"click","disabled"],["routerLinkActive","active","ariaCurrentWhenActive","page",1,"btn","btn-danger",3,"routerLink"],[1,"form-text","text-danger"],[1,"file-info"],[1,"estilo-cat","list-group-item","d-flex","justify-content-between"],[1,"puntero",3,"click"]],template:function(e,s){e&1&&(r(0,"div",2)(1,"h3"),l(2,"Agregar nueva pelicula"),o(),v(3,he,46,12,"div",3),o()),e&2&&(m(3),p("ngIf",s.movie))},dependencies:[V,N,Q,O,K,z,P,D,U,$,H],styles:[".cont-body[_ngcontent-%COMP%]{margin-bottom:100px;min-height:90vh;display:block}.puntero[_ngcontent-%COMP%]{cursor:pointer}.estilo-cat[_ngcontent-%COMP%]{background-color:coral;width:30%;color:#fff}"]});let t=i;return t})();var xe=[{path:"",component:ee}],te=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=S({type:i}),i.\u0275inj=M({imports:[I.forChild(xe),I]});let t=i;return t})();var Oe=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=S({type:i}),i.\u0275inj=M({providers:[A(),w],imports:[q,te,G,Y,X,W,J]});let t=i;return t})();export{Oe as EditMovieModule};
